<!-- Auto-generated by Glass Compiler â€” do not edit directly -->


# Master Contract Outline

## glass.adapters

**Requires:** 

**Guarantees:** "Adapters subsystem namespace is established" on_failure: []

## adapters.typescript

**Requires:** GlassFile has language: typescript

**Guarantees:** LanguageAdapter interface defines name, fileExtension, and compile method; typescriptAdapter implements LanguageAdapter for TypeScript targets on_failure: []

## cli.cmd_annotate

**Requires:** Current directory or --source flag points to a valid Glass project; unitId argument identifies an existing Glass unit

**Guarantees:** With target and note: creates annotation and displays ID; With --list flag: displays all annotations for the unit; With --resolve flag: marks annotation as resolved; Exit code is 0

**Failure Modes:** ProjectNotFound, UnitNotFound, AnnotationNotFound, InvalidTarget

## cli.cmd_audit

**Requires:** 

**Guarantees:** 

## cli.cmd_build

**Requires:** Source directory contains .glass files

**Guarantees:** Runs GlassCompiler.compile() pipeline; Displays diagnostic messages with severity colors; Exit code is 0

**Failure Modes:** CompilationFailed

## cli.cmd_compile

**Requires:** Current directory or --source flag points to a valid Glass project; Output directory is writable

**Guarantees:** All contracts verified before emission; Views generated in glass-views/ directory; TypeScript emitted to output directory; Compilation duration reported; Exit code is 0

**Failure Modes:** ProjectNotFound, VerificationFailed, EmitFailed

## cli.cmd_eject

**Requires:** dist/ directory exists and contains compiled output; Output directory is writable

**Guarantees:** Copies all compiled TypeScript from dist/ to output directory; Copies tsconfig.json and package.json; Creates EJECTED.md documenting the ejection; Ejected project is a standalone TypeScript project; Exit code is 0

**Failure Modes:** DistNotFound, OutputExists

## cli.cmd_init

**Requires:** name argument is a non-empty string

**Guarantees:** Creates project directory with src/, dist/, glass-views/, annotations/, tests/; Creates manifest.glass with project name and default settings; Creates glass.config.json with project configuration; Creates .gitignore with standard Glass ignore patterns; Exit code is 0

**Failure Modes:** DirectoryExists

## cli.cmd_status

**Requires:** Current directory or --source flag points to a valid Glass project

**Guarantees:** Displays summary: total units, verified, failed, pending approvals; Displays per-unit status with pass/fail assertion counts; Exit code is 0

**Failure Modes:** ProjectNotFound

## cli.cmd_trace

**Requires:** Current directory or --source flag points to a valid Glass project; unitId argument identifies an existing Glass unit

**Guarantees:** Displays ancestry chain from root to target unit; Shows purpose, source, and approval for each ancestor; Lists direct children of the target unit; Exit code is 0

**Failure Modes:** ProjectNotFound, UnitNotFound

## cli.cmd_tree

**Requires:** Current directory or --source flag points to a valid Glass project

**Guarantees:** Renders ASCII tree showing parent-child relationships; Each node shows unit ID, purpose, source tag, and approval status; Depth option limits tree rendering depth; Exit code is 0

**Failure Modes:** ProjectNotFound

## cli.cmd_verify

**Requires:** Current directory or --source flag points to a valid Glass project

**Guarantees:** Displays per-unit verification status with pass/fail counts; Verbose mode shows individual assertion details; Exit code is 0 when all units pass

**Failure Modes:** ProjectNotFound, VerificationFailed

## cli.cmd_views

**Requires:** Current directory or --source flag points to a valid Glass project

**Guarantees:** Views generated in glass-views/ directory; Reports count of generated views; Exit code is 0

**Failure Modes:** ProjectNotFound, ViewGenerationFailed

## glass.cli

**Requires:** 

**Guarantees:** "CLI subsystem namespace is established" on_failure: []

## cli.entry

**Requires:** process.argv is available

**Guarantees:** All 11 commands are registered: init, verify, compile, views, status, tree, trace, eject, annotate, build, audit; Version and help flags are available; Command dispatch routes to correct handler

## cli.utils

**Requires:** dir is a valid directory path

**Guarantees:** discoverGlassFiles returns all .glass files recursively under dir; discoverGlassFiles excludes node_modules, glass-views, and manifest.glass; loadProject returns ProjectContext with parsed files, linked tree, and verification results

## compiler.annotations

**Requires:** annotationsDir is a valid directory path; unitId is a non-empty string; target follows valid format: line:<n> or dotted path (intent.*, contract.*, implementation.*)

**Guarantees:** addAnnotation persists annotation to annotations/<unitId>.annotations.json; Each annotation has a unique generated ID; resolveAnnotation sets resolved: true and persists; deleteAnnotation removes the annotation from storage; loadAnnotations returns all annotations for a unit; getUnresolvedAnnotations returns only annotations where resolved is false

**Failure Modes:** UnitNotFound, AnnotationNotFound, InvalidTarget, WriteError

## compiler.ast_verifier

**Requires:** "file is a valid GlassFile with contract and implementation"; "program is a valid ts.Program with type checker"

**Guarantees:** "verifyGuaranteesWithAST proves return types via type checker"; "verifyRequiresWithAST proves parameter types via type checker"; "verifyFailureModesWithAST finds Err() calls, throw statements, catch clauses via AST"; "verifyInvariantsWithAST detects mutation, sensitive data exposure, determinism, statelessness"

## compiler.emitter

**Requires:** "files are verified GlassFile objects (all contracts satisfied)"; "verificationResults contains PROVEN status for each file"; "outputDir is a valid writable path"

**Guarantees:** "Emitted TypeScript compiles with tsc"; "No Glass artifacts in output code"; "Each file has auto-generated header comment"; "tsconfig.json generated for the output"

**Failure Modes:** VerificationNotPassed, WriteError

## glass.compiler

**Requires:** 

**Guarantees:** "Compiler subsystem namespace is established" on_failure: []

## compiler.orchestrator

**Requires:** "sourcePaths is an array of valid file paths"; "CompilerOptions provides rootDir and outDir"

**Guarantees:** "Returns CompilationResult with success: true"; "Pipeline stages execute in order: parse, link, verify, emit"; "Diagnostics array contains info messages for each stage"; "Duration reflects actual elapsed time in milliseconds"

## compiler.linker

**Requires:** "files is an array of valid GlassFile objects"; "each file has a unique id"

**Guarantees:** "Returns IntentTree with all relationships resolved"; "No circular dependencies exist"; "All parent references point to existing files"; "All sub-intent references point to existing files"

**Failure Modes:** DanglingReference, CircularDependency, DuplicateId

## compiler.parser

**Requires:** "filePath is a valid string path"; "file exists on disk for parseGlassFile"; "content follows .glass format with four sections"

**Guarantees:** "Returns GlassFile with all three sections extracted"; "id, version, and language are populated from Glass Unit header"; "Intent has purpose, source, parent, stakeholder, subIntents"; "Contract has requires, guarantees, invariants, fails, advisories"

**Failure Modes:** FileNotFound, InvalidFormat, MissingSection, InvalidSectionContent

## compiler.ts_program_factory

**Requires:** "TypeScript compiler API is available (typescript package installed)"; "projectRoot points to a directory with tsconfig.json"; "GlassFile has a non-empty implementation section"

**Guarantees:** "createProgramFromGlassFile returns a ts.Program with type checker"; "createBatchProgram returns all source files in a single shared program"; "getVirtualPath returns a deterministic path for a unit ID"; "Relative imports in implementations are resolved against actual source"

**Failure Modes:** SyntaxError

## compiler.verifier

**Requires:** "file is a valid GlassFile with contract and implementation"

**Guarantees:** "Returns VerificationResult with all assertions checked"; "Each assertion has a verification level (PROVEN, INSTRUMENTED, TESTED, UNVERIFIABLE)"; "Overall status is PROVEN if all assertions pass"; "verifyAll uses batch ts.Program for performance"; "Uses Phase 2 AST verification when ts.Program available, falls back to Phase 1"

## compiler.view_generator

**Requires:** files is a non-empty array of valid GlassFile objects; tree is a valid IntentTree with all references resolved; results contains a VerificationResult for each file; outputDir is a valid writable path

**Guarantees:** Generates per-unit views: intent outline, contract outline, verification checklist; Generates aggregate views: business view, security view, verification dashboard; Generates master documents: master intent outline, master contract outline; All views are valid markdown with auto-generated header; Returns array of all generated file paths

**Failure Modes:** WriteError, InvalidInput

## glass.framework

**Requires:** 

**Guarantees:** "Glass framework namespace is established" on_failure: []

## glass.entry

**Requires:** 

**Guarantees:** Exports GlassCompiler class; Exports parser functions: parseGlassFile, parseGlassContent; Exports linker functions: linkIntentTree, getAncestors, getChildren; Exports verifier functions: verifyContract, verifyAll; Exports emitter function: emitTypeScript; Exports annotation functions; Exports manifest functions; Exports view generator: generateAllViews; Exports all type definitions from types/index; Exports Result utilities: Ok, Err, mapResult, flatMapResult, collectResults; Exports VERSION constant on_failure: []

## glass.mcp

**Requires:** 

**Guarantees:** "MCP subsystem namespace is established" on_failure: []

## mcp.server

**Requires:** process.argv contains --project <dir> argument; stdio transport is available (stdin/stdout)

**Guarantees:** McpServer created with name glass-mcp-server; All tools registered via registerTools; Server connected to stdio transport

**Failure Modes:** InvalidProjectPath, TransportError

## mcp.tools

**Requires:** server is a valid McpServer instance; projectRoot is a valid directory path

**Guarantees:** Registers 10 tools: glass_init, glass_verify, glass_compile, glass_views, glass_status, glass_tree, glass_trace, glass_annotate, glass_annotations_list; Each tool has a Zod schema for input validation; Each tool returns JSON with success boolean and data/error fields

**Failure Modes:** ToolExecutionFailed

## types.core

**Requires:** "TypeScript strict mode is enabled"

**Guarantees:** "All types compile without errors under strict mode"; "Result<T,E> provides Ok and Err constructors with type narrowing"; "mapResult, flatMapResult, and collectResults are pure functions"; "All PRD domain concepts have corresponding type definitions"; "GlassFile type represents all three .glass sections"; "Contract type includes requires, guarantees, invariants, fails, and advisories" on_failure: []
